<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LeafLet Maps</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
          integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
          crossorigin=""/>
    <script src="jquery.js"></script>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
            integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
            crossorigin=""></script>
    <script>
        var mymap;
        var currentZoom = 10;

        var points = [];


        function setZoom(zoom) {
            mymap.setZoom(zoom);
        }

        function getZoom() {
            return currentZoom;
        }

        function onMapLoad() {
            mymap = L.map('mapid').setView([51.505, -0.09], 10);

            L.tileLayer('http://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(mymap);

            setTimeout(function () {
                JAVA.setZoom();
            }, 1000);

        }

        $(function () {

            onMapLoad();




            $("#clickBtn").click(function () {
                $("#result").html("sddcsd");
                clickController.printValue("Hi!");

            });

            mymap.on("zoomanim", function (event) {
                currentZoom = event.zoom;
                JAVA.log(currentZoom);
                JAVA.setZoom();
            });

            mymap.on("click", function (e) {
                console.log(e);

                var latln = e.latlng;
                //JAVA.log("Add point "+latln.lat);
                //console.log(e.originalEvent.target.tagName);
                if (e.target.localName=='img') {

                } else{
                    //JAVA.addPoint(latln.lat);
                    var point = L.marker([latln.lat, latln.lng]).addTo(mymap);
                    //points.add(point);
                    point.on('click', function (e) {
                        JAVA.log("OK");
                    })
                }
            })




        })

        var JAVA = {
            setZoom: function () {
                javaController.setZoom(currentZoom)
            },
            log: function(val){
                javaController.log(val);
            },
            addPoint: function (val) {
                javaController.addPoint(val);
            }
        }
    </script>
    <style>
        #mapid{
            width:400px;
            height:400px;
        }
    </style>

</head>
<body>
<div id="mapid"></div>
<div id="clickBtn">Click</div>
<div id="result">rr</div>
</body>
</html>